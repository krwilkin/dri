# dri

This repository contains a password-protected ZIP file containing sample R, Python, and SAS code, as well as output from several analyses. This content is intended for researchers within the DRI Center for Genomic Medicine and will be deleted after a short while.

The repository comprises a recent PowerPoint presentation (`slides1.pptx`) and three subdirectories. The PowerPoint slides pertain to research from a monetary incentives experiment in the Survey of Program Participation (SIPP), where we consider the effect of monetary incentives on survey item response.

The three subdirectories are as follows:

## eld_mandate
This directory contains a collection of files used to assess the so-called "ELD Mandate," a recent rule-making requiring that all interstate truck drivers ("long-haul truckers") subject to hours-of-service (HOS) regulations use electronic logging devices (ELDs) to record their duty time (with limited exceptions). One argument against the mandate was that paper logs, which have been used since the 1930s, were sufficient for keeping logs. Proponents, which included insurance industry lobbyists, argued that paper logs are easily falsifiable and inaccurate, and that electronic logs would reduce the paperwork burdent. If paper logs are sufficient at maintaining HOS compliance, then we should see no difference in the hours worked of long-haul truckers before and after the mandate. We identify the effect of the mandate using a difference-in-difference design that comparing the change in hours worked of owner-operators before an after the ELD mandate to that of employee drivers for carriers. Since most carriers that hire drivers manage large fleets, we leverage the fact that most of them had already adopted some form of electronic on-board recording devices, while owner-operators were much more likely to use paper logs.

The analysis uses public monthly household survey data from the Current Population Survey (CPS) for the period 2011 to 2019. The ELD mandate took effect December 18, 2017. This time period covers the expansion following the Great Recession and precedes the nationwide impact of economy-wide disturbances due to the Covid-19 pandemic. While public data have been criticized for measuring truck driver hours, these data can provide useful insights in the absence of proprietary company driver logs (both paper and ELDs and before and after the mandate for the same drivers); the CPS provides relatively high frequency data on and is well-suited to measure labor market activity. We find that the ELD mandate was associated with between an average 2.5 and 3.5-hour reduction in owner-operator weekly hours worked relatively to employee drivers. This effect occurred at the time of the officially announced ELD enforcement deadline and not at other "placebo" treatments (i.e., at ELD rulemaking announcement or the four-month "grace" period).

This analysis is undergoing an overhaul and the files presented are limited. At present, I present a Python script that downloads the individual monthly files (these are raw ASCII fixed-format files stored on servers at the U.S. Census Bureau servers), extracts them, and, using data from the associated schema files (data dictionaries), process the flat files to keep a selection of user-defined variables and save to CSV (`cpsbm_download_redo.py`).

The analysis is conducted in R. The file `cpsbm_import_csv.R` loads the CSV files, appends them into a large pooled data set, and saves to .rds format. The file also makes a first pass at sample restrictions. The file `cpsbm_truckers_work.R` conducts the first round of analysis, which includes calculating summary statistics by operator type (i.e., owners, employees) and derives mean hours worked for various time periods. These statistics are output to CSV files where they can be used in Python to create publication-ready tables; these particular tables are done in Microsoft Word. 

The file `diff_in_diff_manual.py` is a Python file that loads the output from R, organizes the output into dictionaries, and saves them to JSON files. Here, standard errors of the differences are also calculated. The Python file `cps_dd_uncond_diff_docx.py` processes the JSON files and outputs the estimates to a Word file `tab4_cps_dd_uncond_diff.docx`. The JSON files are also presented in this directory with the `.json` file extension.

Finally, the file `appendix_work_legacy.pdf` contains initial work that describes the sample in more detail as well as some data-driven analysis supporting the sample restrictions we made. For example, "truck drivers" are a confounded occupational category in the CPS that includes many drivers that would not be long-haul truck drivers (e.g., sales workers who drive). We show that by restricting truck drivers to being within the trucking industry that most of them would fit the definition of a truck driver that would be subject to the ELD mandate. Of course, the ELD mandate makes exceptions to "local" truck drivers (i.e., those not traveling on interstate routes or those who travel within a 100-mile great circle radius with the same origin-destination node). While the CPS does not distinguish between local and long-haul operations, data from the Bureau of Labor Statistics does. We use estimates for the same industry to get the share of trucking industry production employees in long-haul and local routes. We find that about two-thirds of the industry is in long-haul operations. We conclude that our CPS estimates could have about 33 percent measurement error with a downward bias; that is, our estimates could be underestimated by as much as one third. 

Finally, the PDF explores issues associated with non-random selection into hours response around the timing of the ELD mandate. Truck drivers have some of the highest hours non-response rates of any group. This could be due to the difficulty of reporting their hours (many report a catch-all "hours vary") or their particular sensitivity of sharing hours with federal officials (e.g., if they don't distinguish between Census field interviewers or transportation regulators).

## python_edits_review
This folder shows a couple of Python scripts I use for production work at Census. They are shown to demonstrate competence and creativity with Python and the design of novel data structures used to solve a particular problem.

## sas_code 
I have written tens of thousands of lines of SAS code during my time at Census. It would be difficult to present it all and much of it would be proprietary due to its internal nature. These code samples demonstrate competence with SAS, in particular the use of the \%macro language, arrays, and PROC SQL.
